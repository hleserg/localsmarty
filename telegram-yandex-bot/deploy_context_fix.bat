@echo off
REM –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

echo üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
echo ==================================================

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
if not exist "docker-compose.yml" (
    echo ‚ùå –û—à–∏–±–∫–∞: docker-compose.yml –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.
    pause
    exit /b 1
)

REM –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
echo üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä...
docker compose down

REM –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
echo üî® –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞...
docker compose build --no-cache

REM –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
echo ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä...
docker compose up -d

REM –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞
echo ‚è≥ –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞...
timeout /t 10 /nobreak > nul

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
echo üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞...
docker compose ps

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
echo üìù –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞...
docker compose logs bot --tail=20

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º health check
echo üè• –ü—Ä–æ–≤–µ—Ä—è–µ–º health check...
curl -f http://localhost:11844/health 2>nul || echo ‚ùå Health check –Ω–µ –ø—Ä–æ—à–µ–ª

echo.
echo ‚úÖ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!
echo.
echo üìã –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
echo ‚Ä¢ –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª /app/logs/chat_contexts.json
echo ‚Ä¢ –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
echo ‚Ä¢ –£–ª—É—á—à–µ–Ω—ã fallback —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Å–ª—É—á–∞–µ–≤ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
echo ‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
echo.
echo üß™ –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ business —á–∞—Ç
echo üìä –õ–æ–≥–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π: docker compose logs bot --tail=50
echo üíæ –§–∞–π–ª –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: docker compose exec bot cat /app/logs/chat_contexts.json
echo.
pause
